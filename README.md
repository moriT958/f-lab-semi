# 勤務時間・給料計算アプリ

勤務時間と給料を簡単に計算・管理できるWebアプリケーションです。深夜勤務手当の自動計算や、複数の休憩時間の管理に対応しています。

## 機能

### 主な機能

- **勤務時間の計算**: 開始時刻と終了時刻から実働時間を自動計算
- **休憩時間の管理**: 複数の休憩時間を追加・削除可能
- **深夜勤務手当の自動計算**: 22時～翌5時の勤務時間を自動検出し、1.25倍の時給で計算
- **給料の自動計算**: 時給と実働時間から給料を自動算出
- **勤務記録の保存**: SQLiteデータベースに勤務記録を永続化
- **記録の一覧表示**: 保存された勤務記録を表形式で表示
- **合計の自動計算**: 総実働時間、総深夜勤務時間、総給料を自動集計
- **CSV出力**: 勤務記録をCSVファイルでダウンロード可能
- **記録の削除**: 不要な勤務記録を個別に削除可能

### 計算の詳細

- **実働時間**: 勤務時間から休憩時間を差し引いた時間を分単位で正確に計算
- **深夜勤務**: 22:00～翌5:00の時間帯を自動検出
- **深夜手当**: 深夜勤務時間に対して時給の1.25倍で計算
- **給料計算式**:
  - 通常勤務分: (実働時間 - 深夜勤務時間) × 時給
  - 深夜勤務分: 深夜勤務時間 × 時給 × 1.25

## 技術スタック

### バックエンド

- **Node.js**: サーバーサイドJavaScript実行環境
- **Express**: Webアプリケーションフレームワーク
- **SQLite3**: 軽量データベース（勤務記録の永続化）
- **body-parser**: HTTPリクエストボディのパース

### フロントエンド

- **HTML5**: マークアップ
- **JavaScript (Vanilla)**: UI制御とAPI通信
- **CSS3**: スタイリング

## セットアップ

### 必要環境

- Node.js (バージョン12以上推奨)
- npm (Node.jsに同梱)

### インストール手順

1. プロジェクトディレクトリに移動:

```bash
cd work-tracker-app
```

2. 依存パッケージをインストール:

```bash
npm install
```

3. サーバーを起動:

```bash
npm start
```

4. ブラウザでアクセス:

```
http://localhost:3000
```

## 使い方

### 勤務記録の登録

1. **勤務開始日時**と**勤務終了日時**を入力
2. 休憩がある場合は**休憩開始時刻**と**休憩終了時刻**を入力
   - 複数の休憩がある場合は「休憩を追加」ボタンで追加可能
   - 不要な休憩は「削除」ボタンで削除可能
3. **時給（円）**を入力（デフォルト: 1000円）
4. 「計算して保存」ボタンをクリック

### 記録の確認

- 保存された勤務記録が自動的に表に表示されます
- 画面下部に以下の合計が表示されます:
  - 総実働時間
  - 総深夜勤務時間
  - 総給料

### CSV出力

- 「CSVで保存」ボタンをクリックすると、すべての勤務記録をCSVファイルとしてダウンロードできます
- CSVファイルには合計行も含まれます
- ファイル名: `勤務記録.csv`

### 記録の削除

- 各記録の右側にある「削除」ボタンをクリックすると、その記録を削除できます

## プロジェクト構成

```
work-tracker-app/
├── server.js           # Expressサーバー（API実装）
├── package.json        # プロジェクト設定と依存関係
├── records.db          # SQLiteデータベースファイル（自動生成）
├── 勤務記録.csv        # CSV出力ファイル（ダウンロード時に生成）
└── public/
    └── index.html      # フロントエンド（UI + JavaScript）
```

## API仕様

### POST /records

勤務記録を保存

**リクエストボディ:**

```json
{
  "date": "2025/10/10",
  "time": "9:00:00 - 18:00:00",
  "breakTime": "12:00:00 - 13:00:00",
  "hours": "8.00",
  "night": 0,
  "salary": 8000
}
```

**レスポンス:**

```json
{
  "id": 1
}
```

### GET /records

すべての勤務記録を取得

**レスポンス:**

```json
[
  {
    "id": 1,
    "date": "2025/10/10",
    "time": "9:00:00 - 18:00:00",
    "breakTime": "12:00:00 - 13:00:00",
    "hours": 8.0,
    "night": 0,
    "salary": 8000
  }
]
```

### DELETE /records/:id

指定したIDの勤務記録を削除

**パラメータ:**

- `id`: 削除する記録のID

**レスポンス:**

- ステータスコード 200

### GET /records/csv

すべての勤務記録をCSV形式でダウンロード

**レスポンス:**

- CSVファイル（BOM付きUTF-8エンコーディング）

## データベーススキーマ

### records テーブル

| カラム名  | 型      | 説明                  |
| --------- | ------- | --------------------- |
| id        | INTEGER | 主キー（自動採番）    |
| date      | TEXT    | 勤務日                |
| time      | TEXT    | 勤務時間（開始-終了） |
| breakTime | TEXT    | 休憩時間              |
| hours     | REAL    | 実働時間（時間）      |
| night     | INTEGER | 深夜勤務時間（分）    |
| salary    | INTEGER | 給料（円）            |

## ライセンス

ISC

## 作者

work-tracker-app
